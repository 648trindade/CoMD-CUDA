<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>CoMD: Verifying Correctness</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CoMD
   </div>
   <div id="projectbrief">A Mini-app for Co-Design of Classical Molecular Dynamics.</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('pg_verifying_correctness.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Verifying Correctness </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Verifying the correctness of an MD simulation is challenging.</p>
<p>Because MD is Lyapunov unstable, any small errors, even harmless round-off errors, will lead to a long-term divergence in the atom trajectories. Hence, comparing atom positions at the end of a run is not always a useful verification technique. (Such divergences are not a problem for science applications of MD since they do not alter the statistical physics.) Small, single-particle errors can also be difficult to detect in system-wide quantities such as the kinetic or potential energy that are averaged over a large number of particles.</p>
<p>In spite of these challenges, there are several methods which are likely to catch significant errors.</p>
<h1><a class="anchor" id="sec_ver_cohesive_energy"></a>
Cohesive Energy </h1>
<p>With a perfect lattice as the initial structure (this is the default), the potential energy per atom is the cohesive energy. This value should be computed correctly to many decimal places. Any variation beyond the last 1 or 2 decimal places is cause for investigation. The correct values for the cohesive energy are</p>
<table class="doxtable">
<tr>
<th align="left">Potential </th><th align="left">Cohesive Energy </th></tr>
<tr>
<td align="left">Lennard-Jones </td><td align="left">-1.243619295058 </td></tr>
<tr>
<td align="left">EAM (Adams) </td><td align="left">-3.538079224691 </td></tr>
<tr>
<td align="left">EAM (Mishin) </td><td align="left">-3.539999969176 </td></tr>
</table>
<p>The <a class="el" href="pg_running_comd.html#sec_command_line_options">command line options </a> documentation explains the switches used to select the potential used in the simulation.</p>
<p>Note that the cohesive energy calculation is not sensitive to errors in forces. It is also performed on a highly symmetric structure so there are many errors this will not catch. Still, it is a good first check.</p>
<h1><a class="anchor" id="sec_ver_energy_conservation"></a>
Energy Conservation </h1>
<p>A correctly implemented force kernel, with an appropriate time step (the default value of 1 fs is conservative for temperatures under 10,000K) will conserve total energy over long times to 5 or more digits. Any long term systematic drift in the total energy is a cause for concern.</p>
<p>To facilitate checking energy conservation CoMD prints the final and initial values of the total energy. When comparing these values, pay careful attention to these details:</p>
<ul>
<li>It is common to observe an initial transient change in the total energy. Differences in the total energy of 2-3% can be expected in the first 10-100 time steps.</li>
<li>The best way to check energy conservation is to run at least several thousand steps and look at the slope of the total energy ignoring at least the first one or two thousand steps. More steps are even better.</li>
<li>Set the temperature to at least several hundred K. This ensures that atoms will sample a large range of configurations and expose possible errors.</li>
<li>Fluctuations in the energy can make it difficult to tell if conservation is observed. Increasing the number of atoms will reduce the fluctuations.</li>
</ul>
<h1><a class="anchor" id="sec_ver_particle_conservation"></a>
Particle Conservation </h1>
<p>The simulation should always end with the same number of particles it started with. Any change is a bug. CoMD checks the initial and final number of particles and prints a warning at the end of the simulation if they are not equal.</p>
<h1><a class="anchor" id="sec_ver_reproducibility"></a>
Reproducibility </h1>
<p>The same simulation run repeatedly on the same hardware should produce the same result. Because parallel computing can add elements of non-determinism we do not expect perfect long term reproducibility, however over a few hundred to a few thousand time steps the energies should not exhibit run-to-run differences outside the last 1 or 2 decimal places. Larger differences are a sign of trouble and should be investigated. This kind of test is practically the only way to detect race conditions in shared memory parallelism.</p>
<h1><a class="anchor" id="sec_ver_portability"></a>
Portability </h1>
<p>In our experience, simulations that start from the same initial condition tend to produce very similar trajectories over short terms (100 to 1000 time step), even on different hardware platforms. Short term differences beyond the last 1 or 2 decimal places should likely be investigated.</p>
<h1><a class="anchor" id="sec_ver_general"></a>
General Principles </h1>
<ul>
<li>Simulations run at 0K are too trivial for verification, set the initial temperature to at least several hundred K.</li>
<li>Longer runs are better to check conservation. Compare energies after initial transients are damped out.</li>
<li>Larger runs are better to check conservation. Fluctuations in the energy are averaged out.</li>
<li>Short term (order 100 time steps) discrepancies from run-to-run or platform-to platform beyond the last one or two decimal places are reason for concern. Differences in 4th or 5th decimal place is almost certainly a bug.</li>
<li>Contact the CoMD developers (<a href="#" onclick="location.href='mai'+'lto:'+'exm'+'at'+'ex-'+'co'+'md@'+'ll'+'nl.'+'go'+'v'; return false;">exmat<span style="display: none;">.nosp@m.</span>ex-c<span style="display: none;">.nosp@m.</span>omd@l<span style="display: none;">.nosp@m.</span>lnl.<span style="display: none;">.nosp@m.</span>gov</a>) if you have questions about validation. </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Jun 5 2013 09:13:03 for CoMD by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
