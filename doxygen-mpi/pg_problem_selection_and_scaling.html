<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>CoMD: Problem Selection and Scaling</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CoMD
   </div>
   <div id="projectbrief">A Mini-app for Co-Design of Classical Molecular Dynamics.</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('pg_problem_selection_and_scaling.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Problem Selection and Scaling </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>CoMD is a reference molecular dynamics simulation code as used in materials science.</p>
<h1><a class="anchor" id="sec_problem_spec"></a>
Problem Specification  </h1>
<p>The reference problem is solid Copper starting from a face-centered cubic (FCC) lattice. The initial thermodynamic conditions (Temperature and Volume (via the lattice spacing, lat))can be specified from the command line input. The default is 600 K and standard volume (lat = 3.615 Angstroms). Different temperatures (e.g. T =3000K) and volumes can be specified to melt the system and enhance the interchange of atoms between domains.</p>
<p>The dynamics is micro-canonical (NVE = constant Number of atoms, constant total system Volume, and constant total system Energy). As a result, the temperature is not fixed. Rather, the temperature will adjust from the initial temperature (as specified on the command line) to a final temperature as the total system kinetic energy comes into equilibrium with the total system potential energy.</p>
<p>The total size of the problem (number of atoms) is specified by the number (nx, ny, nz) of FCC unit cells in the x, y, z directions: nAtoms = 4 * nx * ny * nz. The default size is nx = ny = nz = 20 or 32,000 atoms.</p>
<p>The simulation models bulk copper by replicating itself in every direction using periodic boundary conditions.</p>
<p>Two interatomic force models are available: the Lennard-Jones (LJ) two-body potential (<a class="el" href="lj_force_8c.html" title="Computes forces for the 12-6 Lennard Jones (LJ) potential. ">ljForce.c</a>) and the many-body Embedded-Atom Model (EAM) potential (<a class="el" href="eam_8c.html" title="Compute forces for the Embedded Atom Model (EAM). ">eam.c</a>). The LJ potential is included for comparison and is a valid approximation for constant volume and uniform density. The EAM potential is a more accurate model of cohesion in simple metals like Copper and includes the energetics necessary to model non-uniform density and free surfaces.</p>
<h1><a class="anchor" id="sec_scaling_studies"></a>
Scaling Studies in CoMD  </h1>
<p>CoMD implements a simple geometric domain decomposition to divide the total problem space into domains, which are owned by MPI ranks. Each domain is a single-program multiple data (SPMD) partition of the larger problem.</p>
<p>Caution: When doing scaling studies, it is important to distinguish between the problem setup phase and the problem execution phase. Both are important to the workflow of doing molecular dynamics, but it is the execution phase we want to quantify in the scaling studies described below, for that dominates the execution time for long runs (millions of time steps). The problem setup can be an appreciable fraction of the execution time for short runs (the default is 100 time steps) and erroneous conclusions drawn.</p>
<p>This code is configured with timers. The times are reported per particle and the timers for the force calculation, timestep, etc start after the initialization phase is done.</p>
<h2><a class="anchor" id="ssec_weak_scaling"></a>
Weak Scaling  </h2>
<p>A weak scaling test fixes the amount of work per processor and compares the execution time over number of processors. Weak scaling keeps the ratio of inter-processor communication (surface) to intra-processor work (volume) fixed. The amount of inter-processor work scales with the number of processors in the domain and O(1000) atoms per domain are needed for reasonable performance.</p>
<p>Examples,</p>
<ul>
<li>Increase in processor count by 8: <br/>
 (xproc=yproc=zproc=2, nx=ny=nz=20) -&gt; (xproc=yproc=zproc=4, nx=ny=nz=40)</li>
<li>Increase in processor count by 2: <br/>
 (xproc=yproc=zproc=2, nx=ny=nz=20) -&gt; (xproc=yproc=2, zproc=4, nx=ny=20, nz=40)</li>
</ul>
<p>In general, it is wise to keep the ratio of processor count to system size in each direction fixed (i.e. cubic domains): xproc_0 / nx_0 = xproc_1 / nx_1, since this minimizes surface area to volume. Feel free to experiment, you might learn something about algorithms to optimize communication relative to work.</p>
<h2><a class="anchor" id="ssec_strong_scaling"></a>
Strong Scaling </h2>
<p>A strong scaling test fixes the total problem size and compares the execution time for different numbers of processors. Strong scaling increases the ratio of inter-processor communication (surface) to intra-processor work (volume).</p>
<p>Examples,</p>
<ul>
<li>Increase in processor count by 8: <br/>
 (xproc=yproc=zproc=2, nx=ny=nz=20) -&gt; (xproc=yproc=zproc=4, nx=ny=nz=20)</li>
<li>Increase in processor count by 2: <br/>
 (xproc=yproc=zproc=2, nx=ny=nz=20) -&gt; (xproc=yproc=2, zproc=4, nx=ny=nz=20)</li>
</ul>
<p>The domain decomposition requires O(1000) atoms per domain and begins to scale poorly for small numbers of atoms per domain. Again, feel free to experiment, you might learn something here as well. For example, when molecular dynamics codes were written for vector supercomputers, large lists of force pairs were created for the vector processor. These force lists provide a natural force decomposition for early parallel computers (Fast Parallel Algorithms for Short-Range Molecular Dynamics, S. J. Plimpton, J Comp Phys, 117, 1-19 (1995).) Using replicated data, force decomposition can scale to fewer than one atom per processor and is a natural mechanism to exploit intra-processor parallelism.</p>
<p>For further details see for example: <a href="https://support.scinet.utoronto.ca/wiki/index.php/Introduction_To_Performance">https://support.scinet.utoronto.ca/wiki/index.php/Introduction_To_Performance</a> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Jun 3 2013 15:26:52 for CoMD by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
