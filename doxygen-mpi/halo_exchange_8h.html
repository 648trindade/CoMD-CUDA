<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>CoMD: haloExchange.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CoMD
   </div>
   <div id="projectbrief">A Mini-app for Co-Design of Classical Molecular Dynamics.</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('halo_exchange_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">haloExchange.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Communicate halo data such as "ghost" atoms with neighboring tasks.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="mytype_8h_source.html">mytype.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for haloExchange.h:</div>
<div class="dyncontent">
<div class="center"><img src="halo_exchange_8h__incl.png" border="0" usemap="#halo_exchange_8h" alt=""/></div>
<map name="halo_exchange_8h" id="halo_exchange_8h">
<area shape="rect" id="node2" href="mytype_8h.html" title="Frequently needed typedefs." alt="" coords="25,80,103,107"/></map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="halo_exchange_8h__dep__incl.png" border="0" usemap="#halo_exchange_8hdep" alt=""/></div>
<map name="halo_exchange_8hdep" id="halo_exchange_8hdep">
<area shape="rect" id="node2" href="_co_m_d_types_8h.html" title="CoMD data structures." alt="" coords="237,80,347,107"/><area shape="rect" id="node7" href="eam_8c.html" title="Compute forces for the Embedded Atom Model (EAM)." alt="" coords="5,155,64,181"/><area shape="rect" id="node8" href="halo_exchange_8c.html" title="Communicate halo data such as &quot;ghost&quot; atoms with neighboring tasks." alt="" coords="507,155,625,181"/><area shape="rect" id="node3" href="_co_m_d_8c.html" title="Main program." alt="" coords="65,229,137,256"/><area shape="rect" id="node4" href="timestep_8h.html" title="Leapfrog time integrator." alt="" coords="139,155,227,181"/><area shape="rect" id="node9" href="link_cells_8c.html" title="Functions to maintain link cell structures for fast pair finding." alt="" coords="251,155,333,181"/><area shape="rect" id="node10" href="lj_force_8c.html" title="Computes forces for the 12&#45;6 Lennard Jones (LJ) potential." alt="" coords="357,155,432,181"/><area shape="rect" id="node6" href="timestep_8c.html" title="Leapfrog time integrator." alt="" coords="351,229,439,256"/><area shape="rect" id="node5" href="init_atoms_8c.html" title="Initialize the atom configuration." alt="" coords="161,229,252,256"/></map>
</div>
</div>
<p><a href="halo_exchange_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_halo_exchange_st.html">HaloExchangeSt</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A polymorphic structure to store information about a halo exchange.  <a href="struct_halo_exchange_st.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ac71e327a19e97aef72f9ceae0287025b"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct_halo_exchange_st.html">HaloExchangeSt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="halo_exchange_8h.html#ac71e327a19e97aef72f9ceae0287025b">HaloExchange</a></td></tr>
<tr class="memdesc:ac71e327a19e97aef72f9ceae0287025b"><td class="mdescLeft">&#160;</td><td class="mdescRight">A polymorphic structure to store information about a halo exchange.  <a href="#ac71e327a19e97aef72f9ceae0287025b">More...</a><br/></td></tr>
<tr class="separator:ac71e327a19e97aef72f9ceae0287025b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad23258401e7398f07edae0c606d0bcfb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="halo_exchange_8h.html#ac71e327a19e97aef72f9ceae0287025b">HaloExchange</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="halo_exchange_8h.html#ad23258401e7398f07edae0c606d0bcfb">initAtomHaloExchange</a> (struct <a class="el" href="struct_domain_st.html">DomainSt</a> *domain, struct <a class="el" href="struct_link_cell_st.html">LinkCellSt</a> *boxes)</td></tr>
<tr class="memdesc:ad23258401e7398f07edae0c606d0bcfb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a HaloExchange for atom data.  <a href="#ad23258401e7398f07edae0c606d0bcfb">More...</a><br/></td></tr>
<tr class="separator:ad23258401e7398f07edae0c606d0bcfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11079a6e10fd7a6357fdffa6f5107857"><td class="memItemLeft" align="right" valign="top"><a class="el" href="halo_exchange_8h.html#ac71e327a19e97aef72f9ceae0287025b">HaloExchange</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="halo_exchange_8h.html#a11079a6e10fd7a6357fdffa6f5107857">initForceHaloExchange</a> (struct <a class="el" href="struct_domain_st.html">DomainSt</a> *domain, struct <a class="el" href="struct_link_cell_st.html">LinkCellSt</a> *boxes)</td></tr>
<tr class="memdesc:a11079a6e10fd7a6357fdffa6f5107857"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a HaloExchange for force data.  <a href="#a11079a6e10fd7a6357fdffa6f5107857">More...</a><br/></td></tr>
<tr class="separator:a11079a6e10fd7a6357fdffa6f5107857"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84877eb5da5763f36ba159f81b348723"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="halo_exchange_8h.html#a84877eb5da5763f36ba159f81b348723">destroyHaloExchange</a> (<a class="el" href="halo_exchange_8h.html#ac71e327a19e97aef72f9ceae0287025b">HaloExchange</a> **<a class="el" href="halo_exchange_8h.html#a6299c18094f40719d8f69818eedebcc7">haloExchange</a>)</td></tr>
<tr class="memdesc:a84877eb5da5763f36ba159f81b348723"><td class="mdescLeft">&#160;</td><td class="mdescRight">HaloExchange destructor.  <a href="#a84877eb5da5763f36ba159f81b348723">More...</a><br/></td></tr>
<tr class="separator:a84877eb5da5763f36ba159f81b348723"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6299c18094f40719d8f69818eedebcc7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="halo_exchange_8h.html#a6299c18094f40719d8f69818eedebcc7">haloExchange</a> (<a class="el" href="halo_exchange_8h.html#ac71e327a19e97aef72f9ceae0287025b">HaloExchange</a> *haloExchange, void *data)</td></tr>
<tr class="memdesc:a6299c18094f40719d8f69818eedebcc7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute a halo exchange.  <a href="#a6299c18094f40719d8f69818eedebcc7">More...</a><br/></td></tr>
<tr class="separator:a6299c18094f40719d8f69818eedebcc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fd215a00c394182bec1417771cc9231"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="halo_exchange_8h.html#a1fd215a00c394182bec1417771cc9231">sortAtomsInCell</a> (struct <a class="el" href="struct_atoms_st.html">AtomsSt</a> *atoms, struct <a class="el" href="struct_link_cell_st.html">LinkCellSt</a> *boxes, int iBox)</td></tr>
<tr class="memdesc:a1fd215a00c394182bec1417771cc9231"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sort the atoms by gid in the specified link cell.  <a href="#a1fd215a00c394182bec1417771cc9231">More...</a><br/></td></tr>
<tr class="separator:a1fd215a00c394182bec1417771cc9231"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Communicate halo data such as "ghost" atoms with neighboring tasks. </p>

<p>Definition in file <a class="el" href="halo_exchange_8h_source.html">haloExchange.h</a>.</p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ac71e327a19e97aef72f9ceae0287025b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct_halo_exchange_st.html">HaloExchangeSt</a> 
 <a class="el" href="halo_exchange_8h.html#ac71e327a19e97aef72f9ceae0287025b">HaloExchange</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A polymorphic structure to store information about a halo exchange. </p>
<p>This structure can be thought of as an abstract base class that specifies the interface and implements the communication patterns of a halo exchange. Concrete sub-classes supply actual implementations of the loadBuffer, unloadBuffer, and destroy functions, that are specific to the actual data being exchanged. If the subclass needs additional data members, these can be stored in a structure that is pointed to by parms.</p>
<p>Designing the structure this way allows us to re-use the communication code for both atom data and partial force data.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="eam_8c.html#a1edcafec72eaafd6eb3ec01dedb6c70f" title="Calculate potential energy and forces for the EAM potential.">eamForce</a> </dd>
<dd>
<a class="el" href="timestep_8h.html#ac19a9ed6e42be6da5b3aa705ebf2aa84" title="Update local and remote link cells after atoms have moved.">redistributeAtoms</a> </dd></dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a84877eb5da5763f36ba159f81b348723"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroyHaloExchange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="halo_exchange_8h.html#ac71e327a19e97aef72f9ceae0287025b">HaloExchange</a> **&#160;</td>
          <td class="paramname"><em>haloExchange</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>HaloExchange destructor. </p>

<p>Definition at line <a class="el" href="halo_exchange_8c_source.html#l00239">239</a> of file <a class="el" href="halo_exchange_8c_source.html">haloExchange.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="halo_exchange_8h_a84877eb5da5763f36ba159f81b348723_icgraph.png" border="0" usemap="#halo_exchange_8h_a84877eb5da5763f36ba159f81b348723_icgraph" alt=""/></div>
<map name="halo_exchange_8h_a84877eb5da5763f36ba159f81b348723_icgraph" id="halo_exchange_8h_a84877eb5da5763f36ba159f81b348723_icgraph">
<area shape="rect" id="node2" href="_co_m_d_8c.html#aa90c0a0ecf8bba8c512c8c556c5967c8" title="frees all data associated with *ps and frees *ps" alt="" coords="360,5,493,32"/><area shape="rect" id="node4" href="eam_8c.html#abd959aeb739f0c01dac13ab3544be142" title="eamDestroy" alt="" coords="214,56,311,83"/><area shape="rect" id="node3" href="_co_m_d_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="837,31,888,57"/><area shape="rect" id="node5" href="eam_8h.html#ac1d22a30e046f7b354fdeeb235293877" title="Allocate and initialize the EAM potential data structure." alt="" coords="382,56,471,83"/><area shape="rect" id="node6" href="_co_m_d_8c.html#af894f8613ca8116504095340b84eb366" title="decide whether to get LJ or EAM potentials" alt="" coords="542,56,637,83"/><area shape="rect" id="node7" href="_co_m_d_8c.html#ac304e322f79eaff8c0078ffd5bc8b8ab" title="Initialized the main CoMD data stucture, SimFlat, based on command line input from the user..." alt="" coords="685,56,789,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6299c18094f40719d8f69818eedebcc7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void haloExchange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="halo_exchange_8h.html#ac71e327a19e97aef72f9ceae0287025b">HaloExchange</a> *&#160;</td>
          <td class="paramname"><em>haloExchange</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Execute a halo exchange. </p>

<p>Definition at line <a class="el" href="halo_exchange_8c_source.html#l00246">246</a> of file <a class="el" href="halo_exchange_8c_source.html">haloExchange.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="halo_exchange_8h_a6299c18094f40719d8f69818eedebcc7_cgraph.png" border="0" usemap="#halo_exchange_8h_a6299c18094f40719d8f69818eedebcc7_cgraph" alt=""/></div>
<map name="halo_exchange_8h_a6299c18094f40719d8f69818eedebcc7_cgraph" id="halo_exchange_8h_a6299c18094f40719d8f69818eedebcc7_cgraph">
<area shape="rect" id="node2" href="halo_exchange_8c.html#a448c7af8a5ee9fcc5a05966d263c8699" title="This is the function that does the heavy lifting for the communication of halo data." alt="" coords="163,56,274,83"/><area shape="rect" id="node3" href="mem_utils_8h.html#a68c1412c76de7663cb4cbb94d90ddb5b" title="comdMalloc" alt="" coords="349,5,443,32"/><area shape="rect" id="node4" href="parallel_8c.html#a09fe85c4c25e7fd7b8c280f2d2763158" title="Wrapper for MPI_Sendrecv." alt="" coords="323,56,469,83"/><area shape="rect" id="node5" href="mem_utils_8h.html#a6e9c992503ca7d317d2d06dc7de952db" title="comdFree" alt="" coords="354,107,438,133"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="halo_exchange_8h_a6299c18094f40719d8f69818eedebcc7_icgraph.png" border="0" usemap="#halo_exchange_8h_a6299c18094f40719d8f69818eedebcc7_icgraph" alt=""/></div>
<map name="halo_exchange_8h_a6299c18094f40719d8f69818eedebcc7_icgraph" id="halo_exchange_8h_a6299c18094f40719d8f69818eedebcc7_icgraph">
<area shape="rect" id="node2" href="eam_8c.html#a1edcafec72eaafd6eb3ec01dedb6c70f" title="Calculate potential energy and forces for the EAM potential." alt="" coords="163,5,245,32"/><area shape="rect" id="node7" href="timestep_8h.html#ac19a9ed6e42be6da5b3aa705ebf2aa84" title="Update local and remote link cells after atoms have moved." alt="" coords="433,56,565,83"/><area shape="rect" id="node3" href="eam_8h.html#ac1d22a30e046f7b354fdeeb235293877" title="Allocate and initialize the EAM potential data structure." alt="" coords="294,5,383,32"/><area shape="rect" id="node4" href="_co_m_d_8c.html#af894f8613ca8116504095340b84eb366" title="decide whether to get LJ or EAM potentials" alt="" coords="451,5,546,32"/><area shape="rect" id="node5" href="_co_m_d_8c.html#ac304e322f79eaff8c0078ffd5bc8b8ab" title="Initialized the main CoMD data stucture, SimFlat, based on command line input from the user..." alt="" coords="613,5,717,32"/><area shape="rect" id="node6" href="_co_m_d_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="765,31,816,57"/><area shape="rect" id="node8" href="timestep_8h.html#a412cece7eeafdceb6343252471d3dc37" title="Advance the simulation time to t+dt using a leap frog method (equivalent to velocity verlet)..." alt="" coords="627,56,704,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad23258401e7398f07edae0c606d0bcfb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="halo_exchange_8h.html#ac71e327a19e97aef72f9ceae0287025b">HaloExchange</a>* initAtomHaloExchange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decomposition_8h.html#a34a5819a0b47b97378ee81dd90eeedc2">Domain</a> *&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="link_cells_8h.html#af029003339607f1033a378d5e216ccc1">LinkCell</a> *&#160;</td>
          <td class="paramname"><em>boxes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a HaloExchange for atom data. </p>
<p>When called in proper sequence by redistributeAtoms, the atom halo exchange helps serve three purposes:</p>
<ul>
<li>Send ghost atom data to neighbor tasks.</li>
<li>Shift atom coordinates by the global simulation size when they cross periodic boundaries. This shift is performed in loadAtomsBuffer.</li>
<li>Transfer ownership of atoms between tasks as the atoms move across spatial domain boundaries. This transfer of ownership occurs in two places. The former owner gives up ownership when updateLinkCells moves a formerly local atom into a halo link cell. The new owner accepts ownership when unloadAtomsBuffer calls putAtomInBox to place a received atom into a local link cell.</li>
</ul>
<p>This constructor does the following:</p>
<ul>
<li>Sets the bufCapacity to hold the largest possible number of atoms that can be sent across a face.</li>
<li>Initialize function pointers to the atom-specific versions</li>
<li>Sets the number of link cells to send across each face.</li>
<li>Builds the list of link cells to send across each face. As explained in the comments for mkAtomCellList, this list must include any link cell, local or halo, that could possibly contain an atom that needs to be sent across the face. Atoms that need to be sent include "ghost atoms" that are located in local link cells that correspond to halo link cells on receiving tasks as well as formerly local atoms that have just moved into halo link cells and need to be sent to the rank that owns the spatial domain the atom has moved into.</li>
<li>Sets a coordinate shift factor for each face to account for periodic boundary conditions. For most faces the factor is zero. For faces on the +x, +y, or +z face of the simulation domain the factor is -1.0 (to shift the coordinates by -1 times the simulation domain size). For -x, -y, and -z faces of the simulation domain, the factor is +1.0.</li>
</ul>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="timestep_8h.html#ac19a9ed6e42be6da5b3aa705ebf2aa84" title="Update local and remote link cells after atoms have moved.">redistributeAtoms</a> </dd></dl>

<p>Definition at line <a class="el" href="halo_exchange_8c_source.html#l00144">144</a> of file <a class="el" href="halo_exchange_8c_source.html">haloExchange.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="halo_exchange_8h_ad23258401e7398f07edae0c606d0bcfb_cgraph.png" border="0" usemap="#halo_exchange_8h_ad23258401e7398f07edae0c606d0bcfb_cgraph" alt=""/></div>
<map name="halo_exchange_8h_ad23258401e7398f07edae0c606d0bcfb_cgraph" id="halo_exchange_8h_ad23258401e7398f07edae0c606d0bcfb_cgraph">
<area shape="rect" id="node2" href="halo_exchange_8c.html#addffdff2c6d5209a75fa2aae4178d4e4" title="Base class constructor." alt="" coords="237,107,366,133"/><area shape="rect" id="node5" href="halo_exchange_8c.html#a55e8d0e0b1ccf8ab73c15e12da3382d8" title="The loadBuffer function for a halo exchange of atom data." alt="" coords="239,208,364,235"/><area shape="rect" id="node6" href="halo_exchange_8c.html#af0225c2b91c4fea4fa79d762d226e7bc" title="The unloadBuffer function for a halo exchange of atom data." alt="" coords="232,157,371,184"/><area shape="rect" id="node10" href="halo_exchange_8c.html#ab94b139834bbe388c3ff8b8e9d34cb54" title="destroyAtomsExchange" alt="" coords="216,259,387,285"/><area shape="rect" id="node3" href="mem_utils_8h.html#a68c1412c76de7663cb4cbb94d90ddb5b" title="comdMalloc" alt="" coords="443,56,538,83"/><area shape="rect" id="node11" href="halo_exchange_8c.html#ae7697d7cf57c1d431a62a3b802fdc117" title="Make a list of link cells that need to be sent across the specified face." alt="" coords="242,5,361,32"/><area shape="rect" id="node4" href="decomposition_8c.html#ac4b6650f8ae558b450e3e81098fc93c8" title="Find the MPI rank of a neighbor domain from a relative coordinate." alt="" coords="435,107,546,133"/><area shape="rect" id="node7" href="link_cells_8c.html#ade255fea5f6aec94b86bb57424e1ab8b" title="putAtomInBox" alt="" coords="435,157,547,184"/><area shape="rect" id="node8" href="link_cells_8c.html#a2738fea8d13f074f348ca666f3fd8740" title="Get the index of the link cell that contains the specified coordinate." alt="" coords="595,107,733,133"/><area shape="rect" id="node9" href="link_cells_8c.html#aefdb5c50c2b08f163c52c9e7ab5129f4" title="Calculates the link cell index from the grid coords." alt="" coords="782,56,917,83"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="halo_exchange_8h_ad23258401e7398f07edae0c606d0bcfb_icgraph.png" border="0" usemap="#halo_exchange_8h_ad23258401e7398f07edae0c606d0bcfb_icgraph" alt=""/></div>
<map name="halo_exchange_8h_ad23258401e7398f07edae0c606d0bcfb_icgraph" id="halo_exchange_8h_ad23258401e7398f07edae0c606d0bcfb_icgraph">
<area shape="rect" id="node2" href="_co_m_d_8c.html#ac304e322f79eaff8c0078ffd5bc8b8ab" title="Initialized the main CoMD data stucture, SimFlat, based on command line input from the user..." alt="" coords="216,5,320,32"/><area shape="rect" id="node3" href="_co_m_d_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="368,5,419,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a11079a6e10fd7a6357fdffa6f5107857"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="halo_exchange_8h.html#ac71e327a19e97aef72f9ceae0287025b">HaloExchange</a>* initForceHaloExchange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decomposition_8h.html#a34a5819a0b47b97378ee81dd90eeedc2">Domain</a> *&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="link_cells_8h.html#af029003339607f1033a378d5e216ccc1">LinkCell</a> *&#160;</td>
          <td class="paramname"><em>boxes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a HaloExchange for force data. </p>
<p>Create a HaloExchange for force data.</p>
<p>In the force case we only need to exchange data that is needed to complete the force calculation. Since the atoms have not moved we only need to send data from local link cells and we are guaranteed that the same atoms exist in the same order in corresponding halo cells on remote tasks. The only tricky part is the size of the plane of local cells that needs to be sent grows in each direction. This is because the y-axis send must send some of the data that was received from the x-axis send, and the z-axis must send some data from the y-axis send. This accumulation of data to send is responsible for data reaching neighbor cells that share only edges or corners.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="eam_8c.html" title="Compute forces for the Embedded Atom Model (EAM).">eam.c</a> for an explanation of the requirement to exchange force data. </dd></dl>

<p>Definition at line <a class="el" href="halo_exchange_8c_source.html#l00205">205</a> of file <a class="el" href="halo_exchange_8c_source.html">haloExchange.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="halo_exchange_8h_a11079a6e10fd7a6357fdffa6f5107857_cgraph.png" border="0" usemap="#halo_exchange_8h_a11079a6e10fd7a6357fdffa6f5107857_cgraph" alt=""/></div>
<map name="halo_exchange_8h_a11079a6e10fd7a6357fdffa6f5107857_cgraph" id="halo_exchange_8h_a11079a6e10fd7a6357fdffa6f5107857_cgraph">
<area shape="rect" id="node2" href="halo_exchange_8c.html#addffdff2c6d5209a75fa2aae4178d4e4" title="Base class constructor." alt="" coords="237,157,366,184"/><area shape="rect" id="node5" href="halo_exchange_8c.html#a62c01d184d04c4c46bd2a904d073285f" title="The loadBuffer function for a force exchange." alt="" coords="241,208,361,235"/><area shape="rect" id="node6" href="halo_exchange_8c.html#a30670dc4164ae4246695781ea72d4ca4" title="The unloadBuffer function for a force exchange." alt="" coords="234,259,369,285"/><area shape="rect" id="node7" href="halo_exchange_8c.html#a7de35d44e682baed545931fcfa798533" title="destroyForceExchange" alt="" coords="219,309,384,336"/><area shape="rect" id="node3" href="mem_utils_8h.html#a68c1412c76de7663cb4cbb94d90ddb5b" title="comdMalloc" alt="" coords="453,107,547,133"/><area shape="rect" id="node8" href="halo_exchange_8c.html#afb597fcd3c68f5b3fd30f811db78881e" title="Make a list of link cells that need to send data across the specified face." alt="" coords="224,56,379,83"/><area shape="rect" id="node10" href="halo_exchange_8c.html#aaafb7968fbb96f65683a62c1cc2f249a" title="Make a list of link cells that need to receive data across the specified face." alt="" coords="225,5,378,32"/><area shape="rect" id="node4" href="decomposition_8c.html#ac4b6650f8ae558b450e3e81098fc93c8" title="Find the MPI rank of a neighbor domain from a relative coordinate." alt="" coords="445,157,555,184"/><area shape="rect" id="node9" href="link_cells_8c.html#aefdb5c50c2b08f163c52c9e7ab5129f4" title="Calculates the link cell index from the grid coords." alt="" coords="433,31,567,57"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="halo_exchange_8h_a11079a6e10fd7a6357fdffa6f5107857_icgraph.png" border="0" usemap="#halo_exchange_8h_a11079a6e10fd7a6357fdffa6f5107857_icgraph" alt=""/></div>
<map name="halo_exchange_8h_a11079a6e10fd7a6357fdffa6f5107857_icgraph" id="halo_exchange_8h_a11079a6e10fd7a6357fdffa6f5107857_icgraph">
<area shape="rect" id="node2" href="eam_8c.html#a1edcafec72eaafd6eb3ec01dedb6c70f" title="Calculate potential energy and forces for the EAM potential." alt="" coords="219,5,301,32"/><area shape="rect" id="node3" href="eam_8h.html#ac1d22a30e046f7b354fdeeb235293877" title="Allocate and initialize the EAM potential data structure." alt="" coords="350,5,439,32"/><area shape="rect" id="node4" href="_co_m_d_8c.html#af894f8613ca8116504095340b84eb366" title="decide whether to get LJ or EAM potentials" alt="" coords="489,5,583,32"/><area shape="rect" id="node5" href="_co_m_d_8c.html#ac304e322f79eaff8c0078ffd5bc8b8ab" title="Initialized the main CoMD data stucture, SimFlat, based on command line input from the user..." alt="" coords="632,5,736,32"/><area shape="rect" id="node6" href="_co_m_d_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="784,5,835,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1fd215a00c394182bec1417771cc9231"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sortAtomsInCell </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="init_atoms_8h.html#a2b35224968f0f7418171c32a889ce9d0">Atoms</a> *&#160;</td>
          <td class="paramname"><em>atoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="link_cells_8h.html#af029003339607f1033a378d5e216ccc1">LinkCell</a> *&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iBox</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sort the atoms by gid in the specified link cell. </p>
<p>The force exchange assumes that the atoms are in the same order in both a given local link cell and the corresponding remote cell(s). However, the atom exchange does not guarantee this property, especially when atoms cross a domain decomposition boundary and move from one task to another. Trying to maintain the atom order during the atom exchange would immensely complicate that code. Instead, we just sort the atoms after the atom exchange. </p>

<p>Definition at line <a class="el" href="halo_exchange_8c_source.html#l00612">612</a> of file <a class="el" href="halo_exchange_8c_source.html">haloExchange.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="halo_exchange_8h_a1fd215a00c394182bec1417771cc9231_cgraph.png" border="0" usemap="#halo_exchange_8h_a1fd215a00c394182bec1417771cc9231_cgraph" alt=""/></div>
<map name="halo_exchange_8h_a1fd215a00c394182bec1417771cc9231_cgraph" id="halo_exchange_8h_a1fd215a00c394182bec1417771cc9231_cgraph">
<area shape="rect" id="node2" href="halo_exchange_8c.html#adce6df6ee629674941d4af97f7805ebc" title="A function suitable for passing to qsort to sort atoms by gid." alt="" coords="176,5,291,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="halo_exchange_8h_a1fd215a00c394182bec1417771cc9231_icgraph.png" border="0" usemap="#halo_exchange_8h_a1fd215a00c394182bec1417771cc9231_icgraph" alt=""/></div>
<map name="halo_exchange_8h_a1fd215a00c394182bec1417771cc9231_icgraph" id="halo_exchange_8h_a1fd215a00c394182bec1417771cc9231_icgraph">
<area shape="rect" id="node2" href="timestep_8h.html#ac19a9ed6e42be6da5b3aa705ebf2aa84" title="Update local and remote link cells after atoms have moved." alt="" coords="177,31,309,57"/><area shape="rect" id="node3" href="_co_m_d_8c.html#ac304e322f79eaff8c0078ffd5bc8b8ab" title="Initialized the main CoMD data stucture, SimFlat, based on command line input from the user..." alt="" coords="357,5,461,32"/><area shape="rect" id="node5" href="timestep_8h.html#a412cece7eeafdceb6343252471d3dc37" title="Advance the simulation time to t+dt using a leap frog method (equivalent to velocity verlet)..." alt="" coords="371,56,448,83"/><area shape="rect" id="node4" href="_co_m_d_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="509,31,560,57"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="halo_exchange_8h.html">haloExchange.h</a></li>
    <li class="footer">Generated on Wed Jun 5 2013 09:13:00 for CoMD by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
